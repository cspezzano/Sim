#include <Riostream.h>
#include "Trajectory.h"

ClassImp(Trajectory);


//------------------------------------------------------------------------------------------------------------------//
//--------------------------------------------------Default Constructor--------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
Trajectory::Trajectory():TObject(),
 fID(0),
 fX(0.),
 fY(0.),
 fZ(0.),
 fTh(0.),
 fPh(0.)
{}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------Standard Constructor----------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
Trajectory::Trajectory(double x0, 
                       double y0, 
                       double z0, 
                       double th, 
                       double ph,
                       int id):TObject(),
 fX(x0),
 fY(y0),
 fZ(z0),
 fTh(th),
 fPh(ph),
 fID(id)
{}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//

Trajectory:: ~Trajectory()
{}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
void Trajectory::GetDirection(double *dir){
  dir[0] = fTh;
  dir[1] = fPh;
}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//

void Trajectory::GetOrigin(double *origin){
  origin[0] = fX;
  origin[1] = fY;
  origin[2] = fZ;
}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
void Trajectory::SetNewOriginPoint(double x, 
                              double y, 
                              double z){
  fX = x;
  fY = y;
  fZ = z;
}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
void Trajectory::SetNewDirection(double th, 
                                 double ph){
  fTh = th;
  fPh = ph;
}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
void Trajectory::GetParametricPointEvaluation(double t,
                                              double* point){
  point[0] = fX + cos(fPh)*sin(fTh)*t;
  point[1] = fY + sin(fPh)*sin(fTh)*t;
  point[2] = fZ + cos(fTh)*t;
}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
void Trajectory::SetNewOrigin(double t){
  fX =fX+ cos(fPh)*sin(fTh)*t;
  fY =fY+ sin(fPh)*sin(fTh)*t;
  fZ =fZ+ cos(fTh)*t;
}
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------------------//
void Trajectory::PrintStatus()
{
  cout<<"Traj "<<GetID()<<") x,y,z ="<<fX<<"  "<<fY<<"  "<<fZ<<" Dir th,ph= "<<fTh<<"  "<<fPh<<endl; 
}


